<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>oomf</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <style>
      body {
        margin: 1em;
        max-width: 60em;
        background: hsl(220, 90%, 90%);
        line-height: 1.4em;
        font-family: monospace, sans-serif; }
      body, a, a:visited { color: #222; }
      a:hover { text-decoration: none; }
      ul { padding-left: 2em; }
      ul > li { list-style-type: "‚Äî "; }
      #oomf { font-size: 48px; }
      #oomfie { font-size: 24px; }
      #oomf, #oomfie { position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); }
    </style>
    <script>
      if (navigator.maxTouchPoints === 0) window.addEventListener("load", () => {
        const { atan2, floor, sqrt, random, PI } = Math;

        let lastX = floor(random() * window.innerWidth),
            lastY = floor(random() * window.innerHeight);

        // set the background color based on mouse position
        const colorize = ({x, y}) => {
          // limit updates to about 60/s
          window.removeEventListener("mousemove", colorize);
          window.setTimeout(() => window.addEventListener("mousemove", colorize), 17);
          const // compute hsl
            { innerWidth: width, innerHeight: height} = window, // X Y dimension of window
            diag = sqrt(width**2 + height**2),                  // diagonal length
            x0 = floor(width / 2), y0 = floor(height/2),        // center point (origin)
            x1 = x - x0, y1 = y0 - y,                           // adjusted event coordinate
            dist = sqrt((lastX - x) ** 2 + (lastY - y) ** 2),   // distance from last event
            hue = atan2(y1, x1) * 180 / PI,                     // hue <- angle of event from origin
            lit = 80 + 80 * dist / diag,                        // lightness <- distance from last event
            sat = 30 + 120 * sqrt(x1**2 + y1**2) / diag,        // saturation <- distance from origin
            hsl = `hsl(${hue},${sat}%,${lit}%)`;                // hsl css parameter value string
          // set color and last event coordinates
          document.body.style.setProperty('background', hsl);
          lastX = x, lastY = y;
        };

        colorize({x: lastX, y: lastY});
      });

      window.addEventListener('load', () => {
        let angle = 0; // radians
        const
          { PI, cos, sin, floor } = Math,
          orbitalRadius = 100, // pixels
          refreshPeriod = 10, // milliseconds
          orbitalPeriod = 3000, // milliseconds
          angularVelocity = 2 * PI * refreshPeriod / orbitalPeriod;
        const animateOomfie = () => {
          const x = floor(cos(angle) * orbitalRadius), y = floor(sin(angle) * orbitalRadius);
          document.getElementById('oomfie').style.setProperty('transform', `translate(${x}px, ${y}px) translate(-50%,-50%) rotate(${angle + PI/2}rad)`);
          angle -= angularVelocity;
        };
        setInterval(animateOomfie, refreshPeriod);
      });
    </script>
  </head>
  <body>
    <div id="oomf">üê±</div>
    <div id="oomfie">üêÄ</div>
  </body>
</html>
